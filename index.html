<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>심리테스트 (다국어 & 그래프)</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: "Noto Sans KR", sans-serif;
      background: linear-gradient(135deg, #f0f4ff, #dbe9ff);
      margin: 0;
      padding: 0;
      text-align: center;
      min-height: 100vh;
    }
    #app {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      margin-top: 50px;
    }
    button {
      padding: 12px 24px;
      font-size: 1rem;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      margin: 10px;
      transition: 0.3s;
      background-color: #4e7df2;
      color: white;
    }
    button:hover {
      background-color: #345edb;
      transform: scale(1.05);
    }
    .choice {
      display: block;
      margin: 10px auto;
      width: 90%;
      background: #f3f6ff;
      border-radius: 10px;
      padding: 10px;
      cursor: pointer;
      transition: 0.3s;
    }
    .choice:hover {
      background: #e0e7ff;
      transform: translateY(-2px);
    }
    #chartContainer {
      display: none; /* ✅ 시작 시 차트 숨김 */
      margin-top: 20px;
    }
    @media (max-width: 480px) {
      body { padding: 10px; }
      #app { padding: 20px; }
      button { font-size: 0.9rem; }
    }
  </style>
</head>
<body>
  <div id="app">
    <h1 id="title">심리테스트</h1>
    <p id="intro">당신의 성격 유형을 간단히 알아보세요!</p>

    <!-- ✅ 다국어 버튼 -->
    <div id="langButtons">
      <button onclick="setLanguage('ko')">한국어 🇰🇷</button>
      <button onclick="setLanguage('en')">English 🇺🇸</button>
      <button onclick="setLanguage('ja')">日本語 🇯🇵</button>
      <button onclick="setLanguage('fr')">Français 🇫🇷</button>
      <button onclick="setLanguage('es')">Español 🇪🇸</button>
      <button onclick="setLanguage('zh')">中文 🇨🇳</button>
    </div>

    <button id="startBtn" onclick="startTest()">시작하기</button>
    <div id="questionContainer"></div>
    <div id="chartContainer">
      <canvas id="resultChart"></canvas>
    </div>
    <p id="resultText"></p>
  </div>

  <script>
    // ===== 다국어 지원 =====
    const translations = {
      ko: {
        title: "심리테스트",
        intro: "당신의 성격 유형을 간단히 알아보세요!",
        start: "시작하기",
        result: "결과 보기",
        traits: {
          E: "외향성 (E)",
          S: "안정성 (S)",
          O: "개방성 (O)",
          C: "성실성 (C)"
        }
      },
      en: {
        title: "Personality Test",
        intro: "Discover your personality type in a few questions!",
        start: "Start",
        result: "View Results",
        traits: {
          E: "Extraversion (E)",
          S: "Stability (S)",
          O: "Openness (O)",
          C: "Conscientiousness (C)"
        }
      },
      ja: {
        title: "性格診断テスト",
        intro: "いくつかの質問であなたのタイプを知ろう！",
        start: "スタート",
        result: "結果を見る",
        traits: {
          E: "外向性 (E)",
          S: "安定性 (S)",
          O: "開放性 (O)",
          C: "誠実性 (C)"
        }
      },
      fr: {
        title: "Test de personnalité",
        intro: "Découvrez votre type de personnalité en quelques questions !",
        start: "Commencer",
        result: "Voir le résultat",
        traits: {
          E: "Extraversion (E)",
          S: "Stabilité (S)",
          O: "Ouverture (O)",
          C: "Conscience (C)"
        }
      },
      es: {
        title: "Test de personalidad",
        intro: "Descubre tu tipo de personalidad con unas pocas preguntas.",
        start: "Comenzar",
        result: "Ver resultados",
        traits: {
          E: "Extraversión (E)",
          S: "Estabilidad (S)",
          O: "Apertura (O)",
          C: "Responsabilidad (C)"
        }
      },
      zh: {
        title: "性格测试",
        intro: "通过几个问题来了解你的性格类型！",
        start: "开始",
        result: "查看结果",
        traits: {
          E: "外向性 (E)",
          S: "稳定性 (S)",
          O: "开放性 (O)",
          C: "尽责性 (C)"
        }
      }
    };

    let currentLang = "ko";
    function setLanguage(lang) {
      currentLang = lang;
      const t = translations[lang];
      document.getElementById("title").textContent = t.title;
      document.getElementById("intro").textContent = t.intro;
      document.getElementById("startBtn").textContent = t.start;
      speakText(t.intro, lang);
    }

    // ===== 자동 언어 감지 =====
    const userLang = navigator.language.slice(0, 2);
    if (translations[userLang]) setLanguage(userLang);

    // ===== 음성 안내 =====
    function speakText(text, lang) {
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = langMap[lang] || "ko-KR";
      window.speechSynthesis.speak(utter);
    }

    const langMap = {
      ko: "ko-KR", en: "en-US", ja: "ja-JP",
      fr: "fr-FR", es: "es-ES", zh: "zh-CN"
    };

    // ===== 질문 =====
    const questions = [
      { text: "주말에 친구들이 약속을 잡으면 나는…", choices: [
        { text: "적극적으로 나서서 계획을 짠다.", trait: "E" },
        { text: "편하게 쉬는 것을 선호한다.", trait: "S" },
        { text: "새로운 활동을 제안한다.", trait: "O" },
        { text: "일정을 꼼꼼히 확인한다.", trait: "C" }
      ]},
      { text: "낯선 상황에서 나는 보통…", choices: [
        { text: "먼저 대화를 시도한다.", trait: "E" },
        { text: "조용히 상황을 관찰한다.", trait: "S" },
        { text: "호기심을 가지고 탐색한다.", trait: "O" },
        { text: "미리 계획을 세운다.", trait: "C" }
      ]},
      { text: "문제에 부딪혔을 때 나는…", choices: [
        { text: "사람들과 상의한다.", trait: "E" },
        { text: "침착하게 해결책을 찾는다.", trait: "S" },
        { text: "새로운 방식을 시도한다.", trait: "O" },
        { text: "단계별로 해결한다.", trait: "C" }
      ]},
      { text: "회의에서 의견을 말할 때 나는…", choices: [
        { text: "먼저 의견을 낸다.", trait: "E" },
        { text: "타인의 반응을 살핀다.", trait: "S" },
        { text: "창의적인 아이디어를 제시한다.", trait: "O" },
        { text: "데이터로 논리적으로 설명한다.", trait: "C" }
      ]},
      { text: "여행을 계획할 때 나는…", choices: [
        { text: "함께 즐길 사람을 찾는다.", trait: "E" },
        { text: "편안히 쉴 수 있는 곳을 고른다.", trait: "S" },
        { text: "새로운 장소를 탐험한다.", trait: "O" },
        { text: "예산과 일정을 꼼꼼히 짠다.", trait: "C" }
      ]}
    ];

    let current = 0;
    const scores = { E: 0, S: 0, O: 0, C: 0 };

    function startTest() {
      document.getElementById("langButtons").style.display = "none";
      document.getElementById("startBtn").style.display = "none";
      document.getElementById("intro").style.display = "none";
      showQuestion();
    }

    function showQuestion() {
      const q = questions[current];
      if (!q) return showResult();

      const container = document.getElementById("questionContainer");
      container.innerHTML = `<h3>${q.text}</h3>` +
        q.choices.map((c, i) => 
          `<div class='choice' onclick='selectChoice("${c.trait}")'>${c.text}</div>`
        ).join("");

      speakText(q.text, currentLang);
    }

    function selectChoice(trait) {
      scores[trait]++;
      current++;
      showQuestion();
    }

    function showResult() {
      document.getElementById("questionContainer").innerHTML = "";
      const resultText = document.getElementById("resultText");
      const topTrait = Object.entries(scores).sort((a,b)=>b[1]-a[1])[0][0];
      const traitDesc = translations[currentLang].traits[topTrait];
      resultText.textContent = `${translations[currentLang].result}: ${traitDesc}`;

      speakText(resultText.textContent, currentLang);

      // ✅ 차트 표시
      document.getElementById("chartContainer").style.display = "block";
      const ctx = document.getElementById("resultChart");
      new Chart(ctx, {
        type: "radar",
        data: {
          labels: Object.values(translations[currentLang].traits),
          datasets: [{
            label: "Your Personality",
            data: Object.values(scores),
            borderColor: "#4e7df2",
            backgroundColor: "rgba(78,125,242,0.2)",
            borderWidth: 2
          }]
        },
        options: {
          scales: { r: { beginAtZero: true, max: 5 } },
          animation: { duration: 1000 }
        }
      });
    }
  </script>
</body>
</html>
